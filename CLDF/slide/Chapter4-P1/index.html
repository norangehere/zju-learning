<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Chapter 4  Part 1 - zju-learning</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">zju-learning</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../../.." class="nav-link">Welcome to MkDocs</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">CLDF <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Chapter1-3/" class="dropdown-item">Chapter 1 Logic and Digital System</a>
</li>
                                    
<li>
    <a href="../../Chapter4-P1/" class="dropdown-item">Chapter 4  Part 1</a>
</li>
                                    
<li>
    <a href="../../Chapter4-P2/" class="dropdown-item">Chapter 4  Part 2</a>
</li>
                                    
<li>
    <a href="../../Chapter5/" class="dropdown-item">Chapter 5 Digital Hardware Implementation</a>
</li>
                                    
<li>
    <a href="../../Chapter6/" class="dropdown-item">Registers & Register Transfers</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Slide</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../Chapter1-3/" class="dropdown-item">Chapter 1 Logic and Digital System</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">Chapter 4  Part 1</a>
</li>
            
<li>
    <a href="../Chapter4-P2/" class="dropdown-item">Chapter 4  Part 2</a>
</li>
            
<li>
    <a href="../Chapter5/" class="dropdown-item">Chapter 5 Digital Hardware Implementation</a>
</li>
            
<li>
    <a href="../Chapter6/" class="dropdown-item">Registers & Register Transfers</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../Chapter1-3/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../Chapter4-P2/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#chapter-4-part-1" class="nav-link">Chapter 4  Part 1</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#sequential-circuits-introduction" class="nav-link">Sequential Circuits Introduction</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#_1" class="nav-link">时序电路介绍</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_2" class="nav-link">时序电路分类</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_3" class="nav-link">离散事件仿真</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#latch" class="nav-link">Latch</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#flip-flops" class="nav-link">Flip-Flops</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#analysis" class="nav-link">Analysis</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#moore-and-mealy-models" class="nav-link">Moore and Mealy Models</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#filp-flop-timing-parameters" class="nav-link">Filp-Flop Timing Parameters</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#circuit-and-system-level-timing" class="nav-link">Circuit and System Level Timing</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="chapter-4-part-1">Chapter 4  Part 1</h1>
<h1 id="sequential-circuits-introduction">Sequential Circuits Introduction</h1>
<h2 id="_1">时序电路介绍</h2>
<ol>
<li>组成：</li>
</ol>
<p><img src="image-20231116101846007.png" alt="image-20231116101846007" style="zoom:33%;" /></p>
<ul>
<li>现代复杂电路设计大多使用同步</li>
<li>Storage elements: Latches or Flip-Flops</li>
<li>组合逻辑：<ul>
<li>Implements a multiple-output switching function</li>
<li>Inputs are signals from the outside.</li>
<li>Outputs are signals to the outside.</li>
<li>Other inputs, State or Present State are signals from storage elements.</li>
<li>The remaining outputs,Next State are inputs to storage elements.</li>
</ul>
</li>
<li>Combinatorial Logic:<ul>
<li>Next state function(次态方程): Next State = f(Inputs, State)</li>
<li>Output function (Mealy): Outputs = g(Inputs, State)</li>
<li>Output function (Moore): Outputs = h(State)</li>
</ul>
</li>
</ul>
<h2 id="_2">时序电路分类</h2>
<ol>
<li>同步(Synchronous)：在某几个时间检测，什么时候观测输入和改变状态仅与时间信号有关。所有元件在时钟模块控制下同时更新。同步抽象使复杂的设计变得易于处理！</li>
</ol>
<p>CPU：同步</p>
<p>时钟模块：</p>
<pre><code class="language-verilog">always@ (posedge,clk) begin //只要时钟信号向上变动，就会执行该模块 ---&gt; 只在特定情况检测 同步

end
</code></pre>
<ol>
<li>异步(Asynchronous)：在任何时间都可以改变，观测输入与状态，即时响应。</li>
</ol>
<h2 id="_3">离散事件仿真</h2>
<p><img src="image-20231116102538008.png" alt="image-20231116102538008" style="zoom:50%;" /></p>
<h2 id="latch">Latch</h2>
<p><img src="image-20231116102644648.png" alt="image-20231116102644648" style="zoom:50%;" /></p>
<ul>
<li>错误由于$S$变化传到反相器输出有延迟，因此出现$S$由1变0后，$\overline{S}$并未立即由0变1，使得两者都是0，输出也变成了0</li>
</ul>
<h3 id="ay">将A与Y相连，从而得到一个时序电路</h3>
<p><img src="image-20231116103524286.png" alt="image-20231116103524286" style="zoom:50%;" /></p>
<ul>
<li>S为1时，$Y=B$，S为0时，B不改变Y，因此Y可以储存B的值</li>
</ul>
<h3 id="_4">再加一个非门</h3>
<p><img src="image-20231116104213200.png" alt="image-20231116104213200" style="zoom:50%;" /></p>
<ul>
<li>优点：电路简单</li>
<li>缺点：频率不精确 </li>
</ul>
<h3 id="basic-nand-overlines-overliner-latch">Basic (NAND) $\overline{S} – \overline{R}$ Latch 锁存器</h3>
<p><img src="image-20231116104915091.png" alt="image-20231116104915091" style="zoom:50%;" /></p>
<ul>
<li>输入00是禁止的</li>
</ul>
<h3 id="basic-nor-s-r-latch">Basic (NOR) S – R Latch</h3>
<p><img src="image-20231116105805699.png" alt="image-20231116105805699" style="zoom:50%;" /></p>
<h3 id="clocked-s-r-latch">Clocked S-R Latch</h3>
<p><img src="image-20231116110106519.png" alt="image-20231116110106519" style="zoom:50%;" /></p>
<ul>
<li>C为0，锁存器两个输入都为1，不改变值；C为1，输入相当于$\overline{S},\overline{R}$.</li>
</ul>
<h3 id="d-latch">改进：使得没有非法情况——D Latch</h3>
<p><img src="image-20231116110422211.png" alt="image-20231116110422211" style="zoom:50%;" /><img src="image-20231116110545086.png" alt="image-20231116110545086" style="zoom: 50%;" /></p>
<p><img src="image-20231116110824888.png" alt="image-20231116110824888" style="zoom:50%;" /></p>
<h2 id="flip-flops"><strong>Flip-Flops</strong></h2>
<h3 id="the-latch-timing-problem"><strong>The Latch Timing Problem</strong></h3>
<p><img src="image-20231116112417346.png" alt="image-20231116112417346" style="zoom:50%;" /></p>
<ul>
<li>只要 C = 1，Y 的值就会继续变化！</li>
<li>所需行为：Y 在每个时钟脉冲中仅更改一次</li>
<li>解决方案是断开存储元件内从 Y 到 Y 的闭合路径，使用触发器（flip-flop）</li>
<li>a master-slave flip-flop</li>
<li>an edge-triggered flip-flop</li>
</ul>
<h3 id="s-r-master-slave-flip-flop">S-R Master-Slave Flip-Flop</h3>
<p><img src="image-20231116112630386.png" alt="image-20231116112630386" style="zoom:50%;" /></p>
<ul>
<li>左主(master),右从(slave)</li>
<li>假设S=1,R=0，C由0变1，主锁存器对应Q为1；C再变0，从锁存器接收外部输入，即Q与$\overline{Q}$，对应输出Q为1</li>
<li>C在任何状态，S,R输入端都不可能直接改变输出状态</li>
<li>只有当clock完成一次$0\rarr 1\rarr 0$变化的周期后，输出Q才会改变</li>
<li>问题：clock为1时，由于外部输入变化带来的累积效应，使得结果可能错误，称为<strong>1‘s catching</strong></li>
<li>触发器输出的变化会因脉冲宽度而延迟，从而使电路变慢</li>
<li>当 C = 1 时，允许 S 和 R 更改，假设 Q = 0，S 变为 1，然后变回 0，R 保持在 0 。主锁存器设置为 1 ，1 被转移到从锁存器</li>
<li>假设 Q = 0，S 变为 1 并返回 0，R 变为 1 并返回 0 ，主锁存器设置为0，然后复位 0 被传输到从锁存器</li>
</ul>
<h3 id="edge-triggered-flip-flop">Edge-Triggered Flip-Flop</h3>
<p><img src="image-20231116115953446.png" alt="下降沿触发的触发器" style="zoom:50%;" /></p>
<ul>
<li>
<p>主锁存器变为D锁存器</p>
</li>
<li>
<p>只看边沿情况输入决定输出，其他时候输入不影响</p>
</li>
</ul>
<p><img src="image-20231116120653203.png" alt="上升沿触发器" style="zoom:50%;" /></p>
<p>​                                                                                                      上升沿触发器（Positive-Triggered Flip-Flop）</p>
<h3 id="standard-symbols-for-storage-elements">Standard Symbols for Storage Elements</h3>
<p><img src="image-20231116121235712.png" alt="image-20231116121235712" style="zoom:50%;" /></p>
<ul>
<li>主从触发器输出侧的<img src="image-20231116121334780.png" alt="image-20231116121334780" style="zoom:50%;" />表示不允许输入改变。</li>
</ul>
<h3 id="actual-circuit-of-edge-triggered-d-flip-flop"><strong>Actual Circuit of Edge-Triggered D Flip-Flop</strong></h3>
<p><img src="image-20231123101003513.png" alt="image-20231123101003513" style="zoom:50%;" /></p>
<p>6个与非门，成本较低</p>
<h3 id="direct-input">Direct Input</h3>
<p><img src="image-20231116121555284.png" alt="image-20231116121555284" style="zoom:50%;" /></p>
<ul>
<li>
<p>异步赋初值：通过S,R输入为触发器赋初值，多用于系统复位</p>
</li>
<li>
<p>若使用同步赋初值：设置D</p>
</li>
<li>
<p>对所示电路</p>
</li>
<li>
<p>0 applied to R resets the flip-flop to the 0 state</p>
</li>
<li>
<p>0 applied to S sets the flip-flop to the 1 state</p>
</li>
</ul>
<h2 id="analysis">Analysis</h2>
<p><img src="image-20231123101750013.png" alt="image-20231123101750013" style="zoom:50%;" /></p>
<ol>
<li>输入:$x(t)$,输出:$y(t)$,状态:$A(t),B(t)$</li>
<li><img alt="image-20231123101927787" src="../image-20231123101927787.png" /></li>
</ol>
<p>a important equation:$Q=D$</p>
<h3 id="stable-table">Stable Table</h3>
<p><img alt="image-20231123102751300" src="../image-20231123102751300.png" /></p>
<p>有限状态机</p>
<ol>
<li>Alternate State Table 二维表：</li>
</ol>
<p><img alt="image-20231123103333380" src="../image-20231123103333380.png" /></p>
<h3 id="state-diagrams">State Diagrams</h3>
<p>The sequential circuit function can be represented in graphical form as a state diagram with the following components：</p>
<ul>
<li>A circle with the state name in it for each state</li>
<li>A directed arc from the Present State to the Next State for each state transition</li>
<li>A label on each directed arc with the Input values which causes the state transition, and</li>
<li>A label: </li>
<li>On each circle with the output value produced, or</li>
<li>
<p>On each directed arc with the output value produced.</p>
</li>
<li>
<p>Moore type output depends only on state(输出画在圈里面)
   Mealy type output depends on state and input(输出画在有向弧上)</p>
</li>
<li>Example：/左侧输入，右侧输出，由现态指向次态，下例为Mealy型</li>
</ul>
<p><img src="image-20231123104017550.png" alt="image-20231123104017550" style="zoom:50%;" /></p>
<h3 id="equivalent-state-definitions"><strong>Equivalent State Definitions</strong></h3>
<p>两个状态等效，即对任意一种输入都产生相同的输出与次态</p>
<ol>
<li>例：下图中S2与S3</li>
</ol>
<p><img src="image-20231123104617073.png" alt="image-20231123104617073" style="zoom: 50%;" /></p>
<p>因此可以改写</p>
<p><img src="image-20231123104809492.png" alt="image-20231123104809492" style="zoom: 50%;" /></p>
<p>然后发现S1与S2等效</p>
<p><img src="image-20231123104833916.png" alt="image-20231123104833916" style="zoom: 50%;" /></p>
<p>此时不再有可以合并的</p>
<h2 id="moore-and-mealy-models"><strong>Moore and Mealy Models</strong></h2>
<p>Sequential Circuits or Sequential Machines are also called Finite State Machines (FSMs).   Two formal models exist:</p>
<h3 id="moore-model">Moore Model</h3>
<ol>
<li>Outputs are a function ONLY of states.Usually specified on the states.</li>
</ol>
<p><img src="image-20231123105259208.png" alt="image-20231123105259208" style="zoom:50%;" /></p>
<ol>
<li>State Table</li>
</ol>
<p><img src="image-20231123105512825.png" alt="image-20231123105512825" style="zoom:67%;" /></p>
<h3 id="mealy-model">Mealy Model</h3>
<ol>
<li>Outputs are a function of inputs AND states.Usually specified on the state transition arcs.</li>
</ol>
<p><img src="image-20231123105437038.png" alt="image-20231123105437038" style="zoom:50%;" /></p>
<ol>
<li>State Table</li>
</ol>
<p><img src="image-20231123105527342.png" alt="image-20231123105527342" style="zoom:67%;" /></p>
<h3 id="_5">混合型写法</h3>
<p>指向同一个次态的输出相同时把输出放进圈</p>
<p><img src="image-20231123105620730.png" alt="image-20231123105620730" style="zoom: 67%;" /></p>
<h3 id="one-more-example">One more example</h3>
<p>模5计数器，若从0开始，则会0~4循环变化，但若外部干扰产生5-7，下次仍会切换回0-4，从而不会出现死锁与错误。</p>
<p><img src="image-20231123111144007.png" alt="image-20231123111144007" style="zoom:67%;" /></p>
<p><img src="image-20231123111302396.png" alt="image-20231123111302396" style="zoom:50%;" /></p>
<p>Only states reachable from the reset state 000 are used: 000, 001, 010, 011, and 100.
The circuit produces a 1 on Z after four clock periods and every five clock periods thereafter:
000 -&gt; 001 -&gt; 010 -&gt; 011 -&gt; 100 -&gt; 000 -&gt; 001 -&gt; 010 -&gt; 011 -&gt; 100 … </p>
<h2 id="filp-flop-timing-parameters">Filp-Flop Timing Parameters</h2>
<p><img alt="image-20231123112257304" src="../image-20231123112257304.png" /></p>
<ol>
<li>$t_s$：setup time，建立时间</li>
</ol>
<p>根据定义, $t_s$指在采样前触发器需要的准备时间。对于主从触发器，在信号处于上升沿的时候 S 部分的输入是不能改变的，否则可能有一次性采样问题，因此在信号处于上升沿都是触发器的准备时间。这也是为什么现在我们普遍使用边缘触发器的原因。
对于 D 触发器而言，不要卡在时钟边沿改变 D 的输入，而是在时钟改变之前就进行，这样 D 触发器才能有足够的准备时间。</p>
<ol>
<li>$t_h$：hold time，触发边沿后过一段时间输入才能改变。现在多数触发器$t_h$可以是0</li>
<li>
<p>$t_w$：clock pulse width</p>
</li>
<li>
<p>$t_{px}$：propagation delay. Measured from clock edge that triggers the output change to the output change.</p>
</li>
<li>
<p>$t_{PHL}$ :High-to-Low
  $t_{PLH}$ :Low-to-High
  $t_{pd}$:max ($t_{PHL}$,$ t_{PLH}$) </p>
</li>
</ol>
<h2 id="circuit-and-system-level-timing"><strong>Circuit and System Level Timing</strong></h2>
<ol>
<li>
<p>New Timing Components</p>
</li>
<li>
<p>$t_p$  clock period - The interval between occurrences of a specific clock edge in a periodic clock</p>
</li>
<li>
<p>$t_{pd,COMB}$ :total delay of combinational logic along the path from flip-flop output to flip-flop input</p>
<p>组合逻辑在触发器输出到触发器输入路径上的总延迟</p>
</li>
<li>
<p>$t_{pd,FF}$：触发器总延迟</p>
</li>
<li>
<p>$t_{slack}$ ： extra time in the clock period in addition to the sum of the delays and setup time on a path 
     可以是正数，也可以是负数 所有路径上的必须大于或等于零才能正确操作
     Must be greater than or equal to zero on all paths for correct operation</p>
</li>
</ol>
<p><img alt="image-20231123114223146" src="../image-20231123114223146.png" /></p>
<ol>
<li>
<p>Timing Equations：
   $$
   t_p=t_{slack}+(t_{pd,FF}+t_{pd,COMB}+t_s)
   $$
   For $t_{slack}$ greater than or equal to zero,
   $$
   t_p\geqslant max(t_{pd,FF}+t_{pd,COMB}+t_s)
   $$
   for all paths from flip-flop output to flip-flop input</p>
</li>
<li>
<p>Calculation of Allowable $t_{pd,COMB}$</p>
</li>
</ol>
<p><img alt="image-20231123114847350" src="../image-20231123114847350.png" /></p>
<p><img alt="image-20231123114859972" src="../image-20231123114859972.png" /></p>
<p>因此更多使用边沿触发器</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../js/jquery-3.6.0.min.js"></script>
        <script src="../../../js/bootstrap.min.js"></script>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js"></script>
        <script src="../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
